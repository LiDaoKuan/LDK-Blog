---
title: HTTP协议详解
date: 2025-10-14
tags: [HTTP, 网络协议]
categories: 网络编程
---

### HTTP概述

**HTTP** 是一种用作获取诸如 HTML 文档这类资源的协议。它是 Web 上进行任何数据交换的基础，同时，也是一种客户端—服务器（client-server）协议，也就是说，请求是由接受方——通常是 Web 浏览器——发起的。完整网页文档通常由文本、布局描述、图片、视频、脚本等资源构成。

> $HTTP/1.x$ 和 $HTTP/2.x$是基于`TCP`协议的
>
> $HTTP/3$是基于`QUIC`协议的，而`QUIC`协议又是基于`UDP`的
>
> 下文若无特殊说明，讨论的都是 $HTTP/1.x$ 和 $HTTP/2.x$.

客户端与服务端之间通过交换一个个独立的消息（而非数据流）进行通信。由客户端发出的消息被称作*请求*（`request`），由服务端发出的应答消息被称作*响应*（`response`）。

---

### HTTP协议的特点

- 应用层协议：基于 TCP（HTTP/1.1、HTTP/2）或 QUIC（HTTP/3），默认使用80端口。
- 请求-响应模型：通信总是由客户端（如浏览器）发起请求，服务器收到请求后返回响应。服务器不会主动发送数据给客户端。
- 无状态：协议本身不记录之前的请求信息，每个请求都是独立的。为了维护状态（如用户状态），需要借助`Cookie`和`Session`等机制。
- 灵活可扩展：能够传输文本、图片、音视频等任意类型的数据。

---

### HTTP报文

#### HTTP请求报文

$HTTP请求报文$ 由<mark>起始行</mark>、<mark>请求头</mark>、<mark>空行</mark>和<mark>请求体</mark>组成。

##### 请求行：

| 组成部分    | 详情                             | 示例                                                         |
| ----------- | -------------------------------- | ------------------------------------------------------------ |
| 请求方法    | 规定客户端对服务器资源的操作类型 | GET、POST、PUT、DELETE 等                                    |
| 请求路径    | 标识请求资源在服务器上的位置     | 绝对路径，末尾跟上一个'?'和查询字符串。是最常见的形式。例如：`HEAD /test.html?query=alibaba HTTP/1.1`<br />一个完整的 URL，被称为*绝对形式*，主要在使用 `GET` 方法连接到代理时使用。例如：`GET http://developer.mozilla.org/zh-CN/docs/Web/HTTP/Messages HTTP/1.1` |
| HTTP 版本号 | 表明使用的 HTTP协议版本          | HTTP/1.1、HTTP/2 等                                          |

请求行必须在HTTP请求格式的第一行

示例:

`GET /background.png HTTP/1.0`

##### 请求头

包含关于客户端环境、请求的附加信息的一系列键值对。例如：

- `Host`：指定服务器的域名。
- `User-Agent`：浏览器版本信息。服务器通过这个请求头判断用户的软件的应用类型、操作系统、软件开发商以及版本号、浏览器内核信息等； 风控系统、反作弊系统、反爬虫系统等基本会采集这类信息做参考。
- `Connection`：一般设置为`keep-alive`，表示开启 HTTP 持久连接
- `Accept`：告知服务器客户端可以处理的内容类型。比如`text/html`，`application/json`等。
- `Content-Type`：请求体的数据类型（如`application/json`）。post 提交时才需要设置

##### 请求体

可选部分，通常在`POST`、`PUT`等方法中，用于携带要提交的数据（如表单数据、JSON数据等）。

<mark>请求体和请求头之间有一行空行，容易被忽略，但必不可少</mark>。

#### HTTP响应报文

服务器处理完请求后，会返回一个HTTP响应报文。它包含以下部分：

- **状态行**：包含HTTP版本、**状态码**和状态描述。例如 `HTTP/1.1 200 OK`。
- **响应头**：包含服务器返回的关于响应的附加信息。常见的有：`Content-Type`：响应体的数据类型（如`text/html; charset=utf-8`）。`Content-Length`：响应体的长度。`Set-Cookie`：设置Cookie。
- **响应体**：服务器返回的实际数据，如网页的`HTML`代码、图片数据等

