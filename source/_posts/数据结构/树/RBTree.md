---
title: 红黑树
date: 2025-07-14
updated: 2025-07-15
tags: [数据结构, 红黑树, 二叉树, C++]
categories: 数据结构
---

### 概念

> 一种自平衡的二叉搜索树。每个节点额外存储了一个 color 字段 ("RED" or "BLACK")，用于确保树在插入和删除时保持平衡。
>
> 红黑树是 4 阶 B 树（[2-3-4 树](https://oi-wiki.org/ds/2-3-4-tree/)）的变体。

### 特点

红黑树本身也是二叉搜索树，具有所有二叉搜索树的特点。

**一棵合法的红黑树必须遵循以下性质**：

1. （节点颜色）所有节点为红色或黑色。
2. （根节点）**根节点必须是黑色**。
3. （叶子节点）`NIL` 节点（空叶子节点）都是黑色。
4. （红色节点）红色节点的左右子节点都为黑色（从每个`NIL`节点到**根节点**的路径上不能有连续的两个红色节点）
5. （黑色节点）从任意节点到其所在子树的 `NIL` 节点的每条路径上的黑色节点数量相同（简称黑高）

下图为一个合法的红黑树：

![红黑树](https://image-1258881983.cos.ap-beijing.myqcloud.com/imageimage-20250623201450979.png)

### 扩展特点

- 最长路径**不超过**最短路径的两倍。
- 由上一特点可得：任一节点的左右子树的高度差不会超过**2倍**。

> 对比平衡二叉树：平衡二叉树要求左右子树高度相差不超过1，而红黑树要求左右子树高度差不超过2倍。由此看来平衡二叉树对平衡的要求更严格，插入时进行的旋转操作更多。

### 实现

#### 插入

插入的新节点默认是<mark>红色</mark>节点。因为如果对一个红黑树插入一个黑色节点，无论黑色节点插在哪里，都会违反红黑树基本特点中的第5条（因为插入之前的红黑树肯定满足以上所有特点，但插入后一定会破坏第5条）。

那么在插入红色节点的情况下，可能会违反基本特点中的第4条特点（不能有两个连续的红色节点）。如果没有违反特点，则不需要调整。如果违反了特点，就需要进行旋转，分为三种情况：

- 新插入的节点是根节点：直接将根节点变黑（只有在**插入之前树为空**的情况下才会发生）。

- 新插入节点的**叔叔节点**（父节点的兄弟节点）是**红色**：
  - 调整新插入的节点的**父亲、叔叔、爷爷**三个节点的颜色：红色变为黑色，黑色变为红色。
  - 令爷爷节点当作新插入节点，重新判断（循环或者递归）。
  
- 新插入节点的**叔叔节点**是**黑色**：

  - 判断`LL, LR, RR, RL`四种失衡类型，然后旋转。因为只有连续两个红色节点才需要旋转，所以可以确定新插入节点的父节点一定是红色的。据此判断失衡类型。

    - `LL`：

      

    - `LR`：

    - `RR`：

    - `RL`：


#### 删除



#### 查询



```cpp
#include <iostream>


```

